<form #form="ngForm" (ngSubmit)="onSubmit()" class="container">

    <div *ngIf="mensagemErro" class="alert alert-danger mb-3">
        {{ mensagemErro }}
    </div>

    <div class="row">

        <!-- Nome -->
        <div class="col-12">
            <mat-form-field appearance="outline" class="w-100">
                <mat-label>Nome</mat-label>
                <input
                    matInput
                    name="nome"
                    #nomeModel="ngModel"
                    [(ngModel)]="medico.nome"
                    required
                    minlength="3"
                    maxlength="100"
                />
                @if (nomeModel.errors?.['required']) {
                    <mat-error>Nome é obrigatório</mat-error>
                }
                @if (nomeModel.errors?.['minlength']) {
                    <mat-error>Nome deve ter no mínimo 3 caracteres</mat-error>
                }
                @if (nomeModel.errors?.['maxlength']) {
                    <mat-error>Nome pode ter no máximo 100 caracteres</mat-error>
                }
            </mat-form-field>
        </div>

        <!-- Email -->
        <div class="col-12">
            <mat-form-field appearance="outline" class="w-100">
                <mat-label>Email</mat-label>
                <input
                    matInput
                    type="email"
                    name="email"
                    #emailModel="ngModel"
                    [(ngModel)]="medico.email"
                    required
                    minlength="5"
                    maxlength="50"
                    pattern="^[\w._%+-]+@[\w.-]+\.[a-zA-Z]{2,}$"
                />
                
                @if (emailModel.errors?.['required']) {
                    <mat-error>E-mail é obrigatório</mat-error>
                }
                @if (emailModel.errors?.['pattern']) {
                    <mat-error>Formato de e-mail inválido</mat-error>
                }
                @if (emailModel.errors?.['minlength']) {
                    <mat-error>E-mail deve ter no mínimo 5 caracteres</mat-error>
                }
                @if (emailModel.errors?.['maxlength']) {
                    <mat-error>E-mail pode ter no máximo 50 caracteres</mat-error>
                }
            </mat-form-field>
        </div>

        <!-- CRM Sigla -->
        <div class="col-6">
            <mat-form-field appearance="outline" class="w-100">
                <mat-label>CRM Sigla</mat-label>
                <mat-select
                    name="crmSigla"
                    [(ngModel)]="medico.crmSigla"
                    #siglaModel="ngModel"
                    required
                >
                    <mat-option
                        *ngFor="let sigla of siglasCrm"
                        [value]="sigla"
                    >
                        {{ sigla }}
                    </mat-option>
                </mat-select>
                @if (siglaModel.errors?.['required']) {
                    <mat-error>Sigla do CRM é obrigatória</mat-error>
                }
            </mat-form-field>
        </div>

        <!-- CRM Dígitos -->
        <div class="col-6">
            <mat-form-field appearance="outline" class="w-100">
                <mat-label>CRM Dígitos</mat-label>
                <input
                    matInput
                    name="crmDigitos"
                    #digitosModel="ngModel"
                    [(ngModel)]="medico.crmDigitos"
                    required
                    pattern="\d{6}"
                />
                @if (digitosModel.errors?.['required']) {
                    <mat-error>Dígitos do CRM são obrigatórios</mat-error>
                }
                @if (digitosModel.errors?.['pattern']) {
                    <mat-error>CRM deve ter exatamente 6 dígitos numéricos</mat-error>
                }
            </mat-form-field>
        </div>

        <!-- Especialidade -->
        <div class="col-12">
            <mat-form-field appearance="outline" class="w-100">
                <mat-label>Especialidade</mat-label>
                <input
                    matInput
                    name="especialidade"
                    #especialidadeModel="ngModel"
                    [(ngModel)]="medico.especialidade"
                    required
                    required
                    minlength="5"
                    maxlength="50"
                />
                @if (especialidadeModel.errors?.['required']) {
                    <mat-error>Especialidade é obrigatória</mat-error>
                }
                @if (especialidadeModel.errors?.['minlength']) {
                    <mat-error>Especialidade deve ter no mínimo 5 caracteres</mat-error>
                }
                @if (especialidadeModel.errors?.['maxlength']) {
                    <mat-error>Especialidade pode ter no máximo 50 caracteres</mat-error>
                }
            </mat-form-field>
        </div>

        <!-- Telefone -->
        <div class="col-12">
            <mat-form-field appearance="outline" class="w-100">
                <mat-label>Telefone</mat-label>
                <input
                    matInput
                    name="telefone"
                    #telefoneModel="ngModel"
                    [(ngModel)]="medico.telefone"
                    required
                    minlength="10"
                    maxlength="11"
                    pattern="\d{10,11}"
                />
                @if (telefoneModel.errors?.['required']) {
                    <mat-error>Telefone é obrigatório</mat-error>
                }
                @if (telefoneModel.errors?.['pattern']) {
                    <mat-error>Telefone deve conter apenas números com 10 ou 11 dígitos numéricos</mat-error>
                }
                @if (telefoneModel.errors?.['minlength']) {
                    <mat-error>Telefone deve ter no mínimo 10 dígitos</mat-error>
                }
                @if (telefoneModel.errors?.['maxlength']) {
                    <mat-error>Telefone deve ter no máximo 11 dígitos</mat-error>
                }
            </mat-form-field>
        </div>

        <div class="col div-button">
            <button
                type="submit"
                mat-flat-button
                color="primary"
                [disabled]="form.invalid"
            >
                Salvar
            </button>
        </div>
    </div>
</form>
